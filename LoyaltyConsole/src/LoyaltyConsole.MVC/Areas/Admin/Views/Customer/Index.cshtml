@using LoyaltyConsole.MVC.Areas.Admin.ViewModels.CustomerVMs

@model List<CustomerGetVM>
@{
    int count = 0;
}

<!-- Content Start -->
<div class="content">
    <!-- Navbar Start -->
    
    <!-- Navbar End -->

    <!-- Table Start -->
    <div class="container-fluid pt-4 px-4">
        <div class="row g-4">
            <div class="col-12">
                <div class="bg-light rounded h-100 p-4">
                    <div style="display: flex; align-items: center;">
                        <h6 class="mb-0">CUSTOMERS</h6>
                        <div style="width: 100%">
                            <a asp-action="create" class="btn btn-success ms-3">create</a>
                            <input type="text" id="customerSearch" class="form-control d-inline-block"
                                   placeholder="Search by name..." style="width: 250px; display: inline; border-color: black; margin-left: 33rem" />
                        </div>
                    </div>
                    <a style="color: red; font-weight:800; font-size: larger">@TempData["Error"]</a>
                    <div style="margin-top: 10px" class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Birthday</th>
                                    <th scope="col">Gained</th>
                                    <th scope="col">Redeemed</th>
                                    <th scope="col">Available</th>
                                    <th scope="col">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var rew in Model)
                                {
                                    count++;
                                    <tr>
                                        <td>@count</td>
                                        <td>@rew.FullName</td>
                                        <td>@rew.Birthday.ToString("dd/ MM/ yyyy")</td>
                                        <td>@rew.CashbackBalance.TotalCashback</td>
                                        <td>@rew.CashbackBalance.CashbackRedeemed</td>
                                        <td>@rew.CashbackBalance.CashbackAvailable</td>
                                        <td>
                                            <a asp-controller="cashbackbalance" asp-action="update" asp-route-id="@rew.CashbackBalance.Id" class="btn btn-warning">balance</a>
                                            <a asp-action="Update" asp-route-id="@rew.Id" class="btn btn-primary">edit</a>
                                            <a asp-action="Delete" asp-route-id="@rew.Id" class="btn btn-danger">remove</a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Table End -->
</div>
<!-- Content End -->
<!-- Button trigger modal -->

<script>
    document.getElementById("customerSearch").addEventListener("keyup", function () {
        let input = this.value.toLowerCase();
        let rows = document.querySelectorAll("table tbody tr");

        rows.forEach(row => {
            let nameCell = row.querySelector("td:nth-child(2)");
            if (nameCell) {
                let name = nameCell.textContent.toLowerCase();
                row.style.display = name.includes(input) ? "" : "none";
            }
        });
    });
</script>


